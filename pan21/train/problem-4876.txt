For each function, on the second SysListView321 line, enter the index of the microphone you want to use, similarly to the audio device. I switched the keys to numkeys, which is just my own preference - you may have your own choice.
Setting up a batch file to run NirCmd was the easiest way for me, using the setdefaultsounddevice command, ie:
The following script allows you to create a shortcut on the desktop that toggles between two devices. The script may need modifying for the correct device names and uses nircmd which needs downloading. A hotkey for the shortcut could be used. Mainly posting here for a record. The icon and script name toggle to reflect the current device. It is possible for them to get out of sync as there is no check(need a command to get the current default device).
I prefer this as I only need to change my sound output if it is set to the incorrect selection. Hitting scroll-lock switches me to the correct one. Very useful if i am already loading a game and realize it is wrong. Most games need to be restarted if you want to change the sound output.
This is an old question, but I ended up spending some time on it to get what I wanted. I modified Bob's answer to also change the active microphone; useful for me since I have wireless USB headphones that are both an audio device and a listening device, but I just recently got Windows 10 where it can be useful to have my webcam listening for "Hey, Cortana...".