Hopefully more info will come to light on how this attack was able to circumvent both the Plesk login and IP address restrictions.
Without knowing what else your server runs, there's little other people can do to tell you how it was compromised.
After a couple of horror weeks loosing clients and being re-infected we received this reply from technical support at Parallels:
Without auditing and sandboxing, you're going to have a hard time telling what happened. If there's a database running on it, someone could have faulty code on the system. If someone else has access to the server, maybe they did something to infect it. Are the websites running with different file permissions to silo possible damage? Or are the sites pretty much sharing all the resources? Are other users involved and able to run scripts? Do they have different widgets and whatnots installed? Were the files timestamped, so you could go back into the logs to try to glean what happened? 
Basically they are POSTing to the login page and getting in without auth, then going straight for the WYSIWYG file manager and appending the code to js files. Plesk are refusing to acknowledge this and the only option is to firewall plesk off and allow to specific IPs.
Third, what custom code is running on the server outside Plesk? How do you know that was even the infection vector?
First, if there's a rootkit, you're probably fighting a neverending fight. Take the server offline and reinstall and restore backups that are pre-infection. That's the "best" method of fixing.
What's rather interesting though with reference to the first statement is that on the 15th of July Parallels brought another "security" patch.
In the end, the best thing to do is take the server offline and fix it by reinstalling from backups. Otherwise you can't fully trust it. And if you have any "personal" data (user passwords?) they need to be informed that their information may have been stolen. Then start setting up some kind of auditing on the system, and send logfiles to a secondary server over a safe channel of communication so logs can't be erased by an intruder. And run some kind of file checking utility like Stealth on another server to monitor your file integrity and warn you of changes.
This will pull a list of all files in your vhosts directory containing the malware signature. I found it easiest to edit the affected files with Plesk file manager. In my case, all malicious code was appended to the bottom of the infected files.
We have seen this on plesk 9.5 servers despite having Parallel's security patches installed from February. 
I manage a Plesk 9.5.4 server which was infected with the /km0ae9gr6m/ malware. FYI - on my server, the malicious code was added to Javascript, PHP, and HTML/HTM files. I'm posting to let the community know that I was using Plesk's IP address restriction feature at the time of the infection. To be clear - within the Plesk control panel, I had denied Plesk login access to all but two IP addresses (my own studio, and the office IP address of one of my clients). Despite this restriction, log files show logins for the admin user from IP addresses that should not have been allowed by the Plesk firewall. I have since implemented identical address restrictions on port 8443 with IP tables, and to date (approximately 48 hours) have had no further issues. Based on my experience, I say do not trust your security to Plesk's IP address restrictions. If anyone is interested, I would be happy to share my log files.