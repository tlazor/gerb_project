My hypothesis is that some program is preventing or interrupting sleep by performing some action, but I'm stumped as to what it might be. The only application normally running when the program fails to sleep is Mail, and because of the disk access, I was suspicious of Dropbox, but quitting both of them doesn't help.
It went to sleep at 10:37. It woke later at 12:28, and says that the reason it went to sleep before is "Cause 5", which is the only one I ever see. At 1:37, it tried to go to sleep, but didn't because a terminal ("tty") was open, and it stays active for 20 minutes ("1200 second threshold") with no activity. I must have done something intervening because it didn't go to sleep again until 3:45. I woke it again at 4:34, then slept at 4:56.
In the list on the left, select Database Searches > All Messages, and in the upper right, search for "sleep" (no quotes):
I know that playing video with Flash within Safari will allow the display to go to sleep, but not the computer. (Sometimes Flash/Safari gets "stuck" even after closing the page with the Flash, and I have to quit Safari for the system to sleep.) Using an actual media program like DVD Player will of course keep the display on, and the system will not sleep at all. In neither case are there any diagnostic messages that these things have "prevented" sleep.
I'm having problems with getting my late 2009 iMac (running 10.6.4) to sleep, which it is set to do after fifteen minutes of inactivity.
Sleep works fine when manually commanded - the screen, fans and disks shut down, and the lights on USB devices, such as my hub, switch off, but getting the computer to sleep automatically with the energy saver preferences is problematic.
Note that these wake times correlate with the "Previous Sleep Cause" messages above. The first one -- "EHC2", "(EHCI): Port 2" is the keyboard. I pressed a key to wake. The second one is more interesting. I know no one was around the computer at 4:34 -- an "unknown USB device" was connected, and "BRCM2046" was disconnected simultaneously (or in immediate succession). A quick search indicates that BRCM2046 is related to Bluetooth, and that makes sense, because I use a Bluetooth mouse, and sometimes when I wake by pressing a key on the keyboard, the mouse has disconnected, and I have to wiggle it a bit to reconnect. When I move the mouse to wake, the message is different. Here is an earlier sequence:
So that second wake at 4:37 was spurious, because the mouse decided to give up the connection. If someone was present, they would have seen the Mac wake "by itself". It also went back to sleep a little over 20 minutes later, which is what it is set for. (That Time Machine message after wake is also very common, but it does automatically back up later.)
One other thing you might try is to unplug from the network (or turn your wireless network off).  This might help quiet the activity on the machine down and help isolate what might be causing the issue.
Many processes do indeed run in the background.  You can take a look to see what is running at any time via the Activity Monitor, and to see the logs for the easiest way is to use the Console app.  
Does anyone have any suggestions on how to troubleshoot this? Are there any log files that would show if a particular program had woken or prevented sleep?
What happens if you simply turn the computer on and don't log in? Does it go to sleep? What about booting from the OS X DVD? I don't know if it is set to sleep in that case; and if not, whether you can open System Preferences and make that change and have it stick. (Workaround: a clean install to an external drive you can boot from, although that does introduce another variable.) If it never ever sleeps in even the most vanilla scenarios, then maybe it is a hardware issue.
There are also Sleep and Wake messages under Diagnostic and Usage Information > Diagnostic and Usage Messages. But these seem to be just more detail on success.
I have seen the behavior you describe, where the system nods off but then immediately awakens, on an older iMac. But then after it nods off again the second time, it stays asleep. Unfortunately, it's still running 10.4 and the logs and Console app aren't as helpful. It might be some kind of hardware interaction, in which the act of toggling some state is seen as a reason to awaken.
When left idle, the screen saver activates and the display turns off on schedule. The system doesn't actually sleep, though. After about fifteen minutes (I haven't actually timed it), I can hear the fans stop and the disks spool down, but, but connected USB devices don't show any indication of sleep (for instance, the activity lights on my hub don't turn off). After a few seconds, the fans start again and the disks spool back up - though the screen doesn't come on as it would if the mouse was knocked or a USB device was plugged in or out. This then cycles endlessly.