You can only extend a partition if the free space is just after. So after extend, it's a continous partition. You can't have C partition using space after the D partition
http://www.mydigitallife.info/2008/02/19/how-to-mount-and-access-new-partition-volume-or-drive-as-folder-path-in-windows/
I think you can't do it while the OS is started. That's why I can tell you to try to resize it with a linux live-cd, like Gparted-LiveCD, wich support many types of partitions. keep thinking to backup your datas before resizing.
Your D: drive should be in extended partition. After shrinking, the free space is also in extended partition. To extend C: drive, there must be some contiguous unallocated space on the right side of C: drive. Now it's free space but now unallocated space, it's on the right side of D: drive but not C: drive. The two reasons cause extend volume greyed out. You need to backup D: drive -> delete D: drive -> delete extended partition -> right click C: drive and select "Extend Volume".