If you are not using a Volume Licence Key to be legal you will need to enter in a new key for each machine after you load the image. (at the bottom of the 2nd link there is a command line version so you could script it to make the action of loading the image faster.)
I am planning to make a Windows installation in some laptops. I ve planned to make installations, new settings etc in one laptop, take an imageof the disk and mount the image to the other machines. The questions is, what can I do if Windows are already activated? It's a bit illegal I think. Any ideas?
OOBE: Will ask for computer name, reset SSIDs, initial admin user creation, and a new license key for activation.
Sysprep can be found at c:\windows\system32\sysprep\sysprep.exe and you can either choose these options from the GUI or specify them on the command line.
If the computers are all a single brand and came with Windows 7 installed already, you will most likely not have to enter a license key because it will be pulled in from the BIOS/SLIC. This is the case atleast with imaging Dell machines that had OEM Windows 7 installed at the factory.
Before you capture your image, run sysprep. I prefer the OOBE, Generalize, and Shutdown options. These will prepare your image to handle some operations on firstboot.
Generalize: Will make changes to the HAL to accommodate any driver/hardware differences between the machines.