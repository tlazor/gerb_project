Have you tried PowerShell?  Microsoft seems to be seeing the light around using a command-line and PowerShell seems to be their direction for the near future.
Other options include setting the path, turning echo on or off, etc. Run cmd /? from the command prompt to get detailed info on cmd.exe's command line arguments. 
The standard way to run multiple command at once is to separate each command with &&; for example, echo hello && pause will write "hello" to the command prompt, then wait for you to press a key. You can combine this with the /C or /K usage described above to run several commands. In order to use the visual studio command prompt, you may want to have the first command be to change the directory to whatever the VS Command Prompt directory is, using the cd command.
The more easy way is to call upon another batch file or the same batch file can be used. The batch file would have ECHO ON (by default ECHO is ON) so all the commands that you write on the batch file would be shown to the user, unless you do a ECHO OFF. But using method, i do not see why a test.exe would be required unless you want the test.exe to do something else other than opening a batch file and showing commands.
Nevertheless, the test.exe should be created using a programming language which supports opening applications and sending key strokes to it. Is there any programming language you are familiar with? That is if you want the test.exe to open the command prompt and do the job.
So test.exe is sort of like a command prompt window (but specialized), and you want to make a script that executes commands in the Test application. Something like this should work: