If the laptop connects to the router via Wi-Fi, everything works fine. If I connect it via Ethernet, almost everything still works fine: the desktop can see the laptop's shares; the laptop can ping the desktop by name, see it on the network map and in the list of networked computers. However the laptop cannot see the desktop's SMB shares; Explorer displays a "cannot connect" message when I click the computer name in the Network.
So the connectivity is clearly there (since pings work); NetBIOS seems to be working (since the computer is listed in networks and on the map); and the desktop is clearly configured correctly (since laptop->wifi->router->desktop sees those shares just fine). What could be causing this?
I would try uninstalling Windows Live Sign In Assistant and Windows Live Essentials seems to be a useful thing to do.
I have a laptop and a desktop connected via a router. Both are running Win7, and both are configured for Home network with all the settings such as computer discovery enabled.