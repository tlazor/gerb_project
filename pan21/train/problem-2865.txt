I guess this is a two-part question.. First, is this possible, and if so, where would I look? I don't think there's a way to hook into the "drive disconnected" event off the top of my head, at least not without writing drivers.
This should get rid of it. When you're disconnecting the share in the context menu, it should be unmapping it as well but I've seen this disconnect between the GUI and what Windows is actually doing. The above can be easily scripted for your users, and with a bit of VBscript you could potentially have them enter in the Drive letter they wish to have disconnected.
Well, the drive letter is still clearly mapped and if getting rid of that is what you're trying to do, you could jump in the command prompt and go (where x: is the drive letter)
This is not ideal but I know I've seen some weirdness with Windows hanging onto Drive letters even though they should have been unmapped.
The icon remains in Explorer. Attempting to disconnect it again results in an error saying the network location cannot be accessed.. You have to either reboot or kill/restart Explorer to get the "ghost" drive letter to vanish and become available to reuse.
I'd like to make this problem go away for my users, so that if they drop the drive for whatever reason, they can reuse the letter without delay, and without killing their explorer session or requiring a reboot.
Some digging around suggests that this is a common-ish problem, but instead of workarounds, I'd like to see if there is a way to fix this once and for all. Having to restart the shell to get basic functionality working is unacceptable in an enterprise-grade operating system!