The test_input function seems to be from here, and it's really not a good function to use (see here and here). 
Related but not PHP code effort: have email admin limit number of outgoing messages, IP address sources that can connect with this isolated SMTP account.
In short: it isn't recommended defense against anything (the recommendation for XSS are to HTML encode when outputting data, not when receiving it, and the function doesn't provide defense against anything else), and it makes your data dirty, leading to usability problems.
Limit length of incoming, outgoing data. Restrict incoming POST or other to only the character ranges needed. UTF8 has characters which you likely don't need to support; some are used for abusive purposes. Use regular expressions to check incoming POST or other data. Consider captcha's for limiting abuse. If possible do not support emails containing markup. Unset, clear or overwrite each variable when finished with it.
For basic information, why is an html message REQUIRED? Output the data the user needs in plain text and email. 
Place lines of code containing credentials for SMTP user account into a separate file without a PHP file extension. Use Apache or other server side restrictions to prevent any direct access. Use file system permissions to restrict access also. Then use require_once within the PHP script to then include this file. 