I've setup port forwarding on my router so that communication on a certain port to my public IP address is forwarded to my Server's local IP. With this setup, my Server can see the clients and receive incoming messages from the client but for some reason it tries to send out messages to clients on their local IP addresses from my friend's home network. The Servers and Clients are using a proprietary TCP/IP protocol. My Server sees the client's IP addresses as 192.168.0.X as shown in the diagram below. Any ideas on what we could be doing wrong? I would have thought that the communication from clients would come from my friend's public IP? It could be the case that our protocol messages are coming in with the local IP and the server is parsing those messages to reply on the endpoints at the Client's local IP. In this case, without changing our protocol, is there some sort of networking magic that would enable the communication to work?
Constraints are that the Server and Clients are "locked" devices so we would like to avoid OS/App level changes. May be we can setup some sort of VPN or VLAN (is that a thing over internet)? So stated differently, our preference is to come up with a networking solution to this problem. We can add devices other than the Server and Client to the network to solve this but we wouldn't want to "program" a new application that routes our protocol messages.
I am a networking illiterate but I am trying to make a Server on my home network communicate with some Clients on my friend's home network over the Internet. Neither my friend nor I have a static public IP and we are not looking to buy static IPs for our clients and server.