The next thing I did was include collectl's formatit.ph file since that's where all the print routines live and by populating the right variables with WMI data I could then simply call the right routines and I could get data in any format collectl reports it in.=, including time stamps and space-separated data.
BUT as I said the data was not consistent or complete and it was really more of an exercise than anything else.  However, if someone wants to write their own WMI data collection routines in perl and is looking to integrate them with the collectl print routines I can probably provide some consulting to help you take it to that next level.  But the first step is getting the data.
I know very little about performance monitoring on windows other than by using perfmon.  When I wrote collectl I actually did toy with the idea of seeing what I could do with windows and even played around with WMI - turns out you can connect to a windows box with WMI and retrieve the same data as you can with perfmon.  The only thing is when I tried it the numbers I got were different than what perfmon reports.  For example, there are a couple of CPU counters called %, but the numbers they report look nothing like percentages.  I was able to get disk numbers and even some of network and memory.