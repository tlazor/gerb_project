This seems to be in general related to power management of the device Intel(R) Management Engine Interface in Device Manager under System devices.
On next reboot, I tested stuff out, and everything worked fine. The shutdown instead of sleep issue was fixed.
Many people have had this error and oftentimes the cause is different, but I want to post a solution I found that completely solved it for me. This problem is caused by an erroneous driver in Windows (that is why Linux and Safe Mode work fine). In most cases, it seems that the device responsible is 'Intel(R) Management Engine Interface' (under 'System devices' in device manager). To solve the problem, you need to right-click and disable the device or roll back the driver to anything older than 11.xxx, don't uninstall the device because you will need to reinstall it manually if this does not fix the problem. For me, disabling it worked and the computer now behaves normally.
To resolve just go to the power setting option and under the "When I close the lid" change it to "do nothing" and save. Then open it again and change it back to "Sleep" and save.
In device properties, You can uncheck/ untick the Allow the computer to turn off this device to save power option. This is described graphically here (also the source of the screenshots!).
Finally managed to resolve it. I think what happened was that it somehow lost the original settings, became null or something.
I'm guessing that Windows Update installed the wrong drivers for my laptop given that the version numbers are wildly different. In contrast to another top voted answer, I had to update as there was nothing to roll back to.
Just solved the issue on my laptop. In my case, I had to update to the latest Intel MEI driver (or replaced it with the right version? See note below).
I know this will not fix the problem for 100% of cases, but this is the most commonly successful solution that I have found online. I have also found people saying sound card and graphics drivers are to blame, but I have not tested those so I am not sure.