If you want to clean things up after an error in C, you might want to look into setjmp() and longjmp() and include setjmp.h in the file.
The largest problem I see with this code is that it is almost impossible to maintain. Programmers, software engineers and developers generally work in teams. You may be on vacation, you may have won the lottery, or someone may have left you five million dollars when this code needs to be updated. Trying to insert a line in a macro can be a nightmare. In the days before the ANSI C standard (before C89) large blocks of code like this might have been Okay for performance reasons, these days is best to write small functions that do only one thing and build the program up from the small functions.
It's difficult to get a large macro to compile since any syntax errors are all reported on the same line. It's difficult to debug because most debuggers will only show the macro, and any errors that get thrown are all on one line.
Using a rather complex macro rather than a function or multiple functions greatly increases the complexity of the code as does goto statements hidden in macros.