Are there any conventional/well known ways to do this? I've been approaching this problem as a machine learning engineer, still a newbie in networking. I can think of a few ways to use behavioral biometrics on the network traffic, but that would be a very resource heavy way of solving the problem (and not necessarily very accurate).
A user can not be directly identified at the transport layer. The common ways firewalls handle this is by associating the IP address somehow with the user and then mapping any flows to a user based on source IP address. Of course this will fail if there are multiple users behind the same source IP, like in multi user systems (UNIX, Windows Terminal Server...) or if the source of the traffic is a network with NAT where multiple IP addresses are mapped to a single one.
I'm building a router that uses machine learning to recognize certain network flows for bandwidth allocation and it has become apparent I will need to maintain a lookup table of users in the system. I will only have access to the data at the transport layer, and I'm unsure how to be certain who's who in a dynamic system (assuming the majority of the packet data will be encrypted).