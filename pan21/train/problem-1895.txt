I avoid MSWindows as much as possible on servers - but I was unaware that PHP will create a mail.log file (it's very unusual that PHP would interact with files in such a way at all given it's architecture) and there's nothing in the code you've published which would write such a file. Are you sure this is not created by your MTA?
I doubt it is your problem but, there is also a "sendmail_from" setting that is for Win32 only. Should be directly below your "smtp_port" setting in php.ini.
Have you tried sending an email by entering SMTP commands directly into a telnet session? Using a different email client on the system?
Perhaps the removal of SQL Server caused the problem. Do you have the SMTP Server feature installed on the IIS box? If not, I think you'll need to either install it, or you'll need to point to a real SMTP Server in php.ini rather than SMTP=localhost.
Under the virtual SMTP server's properties - on the "Access" tab, I granted permission for the public IP address of the server to relay email. Stop and then started the SMTP server, and all is well. Note that I had mentioned that email from the PHP application never landed in the pickup folder - it still doesn't. It does go to the queue folder however. (The SMTP server properties can be accessed using the IIS 6.0 Manager.)