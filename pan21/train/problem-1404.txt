Must say, for the status MS tries to uphold with their software this is a very sad situation of course. Should have been fixed at least half a year ago. So also with this brand new Pro 4 the same problem - on my way to number 4 (for free, if not I will team up with Google/Samsung after 27 years of MS for sure).
The workaround that works every ones of out 4 tries (sometimes many more) is to, while running the Surface, do the switch-off/volume-up trick after you uninstalled the keyboard driver and then it restart from the boot-screen that turns up. 
I am working on my 3rd Surface Pro 4 now within 17 months; each time the type cover problem (and some other backed-in 'problems' or after installing the Anniversary Update - don't!!) led to a full service new delivery, MS has no solution yet (May 17th 2017) and stalls is for the 3 and 4 users to order the new Surface Pro. Several times I spend hours on the phone with their technicians (situated all around the world) and they can take-over your Surface, fix it, but when the user for example uses the Dock, a new mouse, etc. (there are tons of reasons) the type cover driver disappears again. I know that if you allow MS to key-log your device all becomes more easy ... but I'd like to keep at least the illusion of a bit of privacy, so now way I'll go for that 'solution'. 