Take for example Microsoft Office document files (.docx, .xlsx, etc).  They're really zip files with special contents that Microsoft Office knows how to open.  So if the operating system were to guess based on the file format, it would see that they're valid zip files and open it them up in your compression program.  Unless it first unzipped the files and then started looking at the contents to see if really the files were Excel files, at which point it would delete the temporarily unzipped copy and pass the original file to Excel.  This could possibly be done, but you end up having to have a lot of logic in the OS to make these sorts of guesses.
For example, if we rename a .pdf file to .exe, and try to run it under windows, an error will occur. But is it possible for OS to determine which program to use to open a file based on its content? not just hiding its extension part.
There are programs which attempt to make this guess - for example, the UNIX program file.  You can look at the magic number page on Wikipedia to get an idea for how this works.  The problem you might run into here is if someone particularly dense used someone else's magic number, you're back to looking at the file extension.  Imagine a non-PDF file format with "%PDF".