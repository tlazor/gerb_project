A couple of days ago one of my hard drives stopped being recognised in Windows. It was still recognised in the bios so the actual drive appeared fine and after a bit of investigation I figured that it was the drives partition table that was the problem.
In terms of get data back if you haven't already backed up all your data it may already be too late.  Spinrite might help, but otherwise you will have to pay for professional data recovery specialist which can exceed $1000 depending on the severity of the damage.
So I downloaded TestDisk and ran it to see if it could do anything. At the time it detected the drive and I could see that the files were still on there so it did indeed look like it was the partition table. I then used TestDisk to recover the faulty partition, which seemed successful.
If you want to keep using the hard drive NOPE. Not ever going to happen, even if spinrite repairs the bad sectors, the drive is dying and continuing to use it is like a time bomb and you never know when it will fail hard and lose all your data.
Using a live linux USB/DVD/CD you might still be able to read & recover some data from the drive, ddrescue is pretty good with drives that are mostly readable.
However it just seems to have made things worse. Now the hard drive is only detectable in the bios and no longer appears anywhere in the system, TestDisk or any partition software. 
If it's in a desktop tower, a cable (or the power, or motherboard) could be going bad, try swapping with other data / power cables (or other known good parts). Or try using the drive in another computer.
So what did TestDisk actually do and is there anyway to undo whatever damage it did? Does anyone know of any decent software that can be used to recover lost partitions or should I move onto data recovery tools? 
TestDisk is usually really good, but I'd guess your drive is failing for other reasons, whatever caused the first error before TestDisk did anything is probably still there. TestDisk usually only writes partition tables, but doesn't touch the actual data outside partition tables.
You could get spinrite from grc.com for $70, and it may or may not recover some of your bad sectors.  You probably have a bad sector in the partition table now, and that is why windows doesn't recognize it.