As pointed above correctly, OpenVZ is not complete virtualization since each VPS does not have its own kernel. With KVM, each VM will have its own kernel and they very well isolated from other VM's on same host machine. Specific to your query of CPU allocation, we have seen KVM to be MUCH better at sharing the CPU resources and smartly monitoring it at all times. Hence, my vote will be for KVM.
For my 4 cores but 8 threads CPU, which virtualization type would I need for setting up, with my Intel Xeon processor, about 30-40 VPS's per dedicated server? Both CPU and RAM must be shared among the VPS's.
OpenVZ is containerization, that runs under the same kernel as the host, and creates environment (containers with their filesytem, users, network interfaces) that are isolated one each other.
Choosing between KVM and OpenVZ should not depend on the CPU you have, but rather on what will be your workload, will it be for different companies or customers ...
I have a 4 cores/8 threads Intel Xeon processor. This is something I tried to particularly ask in SolusVM support, however I haven't got a good reply. I even don't know if they are right: they told me to, as I have 8 threads for 4 cores, opt for KVM for a great CPU sharing among VPS's. As I understood, they said OpenVZ won't support all the 8 threads (so that I can use my  entire processor resources). But I know that OpenVZ is lightweight and, in most cases, works faster, so I have a preference for OpenVZ.